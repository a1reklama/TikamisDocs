# Запись

--

#### Услуги:

```json
"items": [
  {
    "id": "1d",
    "sectionId": "1s",
    "name": "Услуга из раздела Двигатель №1",
    "price": 1500,
    "sale": 1000,
    "textSale": [
      "При покупке моторного масла в сети магазинов «ТИКАМИС» замена моторного масла производится по цене 50 рублей независимо от суммы покупки.",
      "Указанная стоимость по замене масла в двигателе действует при покупке не менее 4-х литров моторного масла и при наличии записи о такой покупке в кассовом чеке.",
      "Работы по обнулению интервала ТО автомобиля включены в стоимость замены масла в двигателе."
    ]
  },
  {
    "id": "2d",
    "sectionId": "1s",
    "name": "Услуга из раздела Двигатель №2",
    "price": 1000,
    "sale": false,
    "textSale": false
  }
]
```

| Свойство  | Тип                | Описание                                                                                 |
| --------- | ------------------ | ---------------------------------------------------------------------------------------- |
| id        | string             | ID услуги                                                                                |
| sectionId | string             | ID раздела, к которому привязана услуга                                                  |
| name      | string             | Название услуги                                                                          |
| price     | number             | Цена услуги                                                                              |
| sale      | number или boolean | Цена услуги со скидкой при активации QR-кода (может быть false, если скидка отсутствует) |
| textSale  | array или boolean  | Массив строк. Каждая строка - это абзац. False, если скидки не предусмотрено             |

### Разделы:

```json
"sections": [
  { "id": "1s", "name": "Двигатель" },
  { "id": "2s", "name": "Трансмиссия" }
]
```

| Свойство | Тип    | Описание         |
| -------- | ------ | ---------------- |
| id       | string | ID раздела       |
| name     | string | Название раздела |

### Корзина (аналогична массиву услуг):

GET /api/cart/ - получить элементы корзины

POST /api/cart/ - добавить элемент в коризну по ID услуги

DELETE /api/cart/{id} - удалить элемент из корзины по ID услуги

```json
"cart": [
    {
        "id": "1d",
        "sectionId": "1s",
        "name": "Услуга из раздела Двигатель №1",
        "price": 1500,
        "sale": 1000,
        "textSale": [
          "При покупке моторного масла в сети магазинов «ТИКАМИС» замена моторного масла производится по цене 50 рублей независимо от суммы покупки.",
          "Указанная стоимость по замене масла в двигателе действует при покупке не менее 4-х литров моторного масла и при наличии записи о такой покупке в кассовом чеке.",
          "Работы по обнулению интервала ТО автомобиля включены в стоимость замены масла в двигателе."
        ]
    },
    {
        "id": "2d",
        "sectionId": "1s",
        "name": "Услуга из раздела Двигатель №2",
        "price": 1000,
        "sale": false,
        "textSale": false
    }
]
```

### Города

Примеры запросов:

GET /api/cities/ - получить все города

GET /api/cities/moscow - получить сервисные центры данного города (массив центров см. ниже)


```json
    "cities": [
        {
            "name": "Москва",
            "slug": "moscow"
        },
        {
            "name": "Москва",
            "slug": "moscow"
        }
    ]
```

| Свойство      | Тип    | Описание              |
| ------------- | ------ | --------------------- |
| cities        | array  | Массив городов        |
| cities[].name | string | Название города       |
| cities[].slug | string | Символьный код города |

### Сервисные центры:

Пример запроса:

GET /api/cities/moscow/gagarina15/ - получить услуги центра на Гагарина 15 в городе Москва (массив услуг см. выше)

```json
"centers":[
    { "name": "пр-т Гагарина, 15", "record": false, "slug": "gagarina15", "mapLink": "https://<ссылка_на_карту>" },
    { "name": "пр-т Гагарина, 999", "record": true, "slug": "gagarina999", "mapLink": "https://<ссылка_на_карту>" },
  ]
```

| Свойство         | Тип     | Описание                                     |
| ---------------- | ------- | -------------------------------------------- |
| centers          | array   | Массив центров                               |
| centers[].name   | string  | Название центра                              |
| centers[].record | boolean | Возможна ли запись в данном сервисном центре |
| centers[].slug   | string  | Символьный код центра                        |
| centers[].mapLink   | string  | Ссылка на карты (для "Посмотреть на карте")|                        |

### Выбрать дату для записи на услугу

Тут не особо понятно как лучше. Судя по-всему как то получать дни, на которых возможна запись, из массива корзины (выбранных услуг)

Примеры запросов:

GET /api/days/2022-11-18/ - получить массив времен для записи. То есть формируем исходя из данных о корзине, городе, центре и так далее

```json
    "days": [
        "2022-11-18",
        "2022-12-10"
    ]
```

| Свойство | Тип                  | Описание                                                                                                                                                                                 |
| -------- | -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| days     | array                | Дни                                                                                                                                                                                      |
| days[]   | string или timestamp | Полная дата. Желательно сделать в формате гггг-мм-дд, так как я уже настроил под этот формат. Если так не вариант, можно будет попробовать timestamp, я потом преобразую в нужный формат |

### Выбрать время для записи

Из запроса выше судя по всему получаем массив времени. Скорее всего будет исходить из режима работы сервисного центра и минимального времени оказания услуги (например, 30 мин).
Допустим, режим работы СЦ с 10:00 до 21:00, тогда:

```json
    "timeList": [
        {
            "time": "10:00",
            "free": true
        },
         {
            "time": "10:30",
            "free": true
        },
        {
            "time": "11:00",
            "free": false
        },
        // ....
        {
            "time": "20:30",
            "free": false
        },
    ]
```

| Свойство        | Тип                  | Описание                          |
| --------------- | -------------------- | --------------------------------- |
| timeList        | array                | Массив времени                    |
| timeList[].time | string или timestamp | Время. Желательно формат час:мин. |
| timeList[].free | boolean              | Свободно/занято                   |

### Данные новой записи:

То есть, то что человек выбрал (если нужно, конечно же тебе). Мне это нужно было для валидации

```json
    "data": {
        "city": "moscow", // город (Обязательное поле)
        "center": "gagarina15", // центр (Обязательное поле)
        "date": "2022-11-18", // дата записи (Обязательное поле)
        "time": "10-30", // время записи (Обязательное поле)
        "phone": "+7 (999) 999-99-99", // номер телефона
        "gosNumber": "A777AA", // гос.номер авто
        "region": "86", // регион авто
    },
```

### Предстоящие записи:

Примеры запросов:

GET /api/records/ - получить список предстоящих записей

POST /api/records/ - новая запись

DELETE /api/records/{id} - удалить запись по ID


Дальше там уже при составлении ТЗ на бэкенд, возможно еще опишут изменение предстоящей записи.

PUT /api/records/{id} - изменить данные записи

```json
"records": [
    {
      "id": "3r",
      "date": "2021-09-25",
      "time": "15:30",
      "city": "moscow",
      "address": "gagarina15",
      "services": ["1t", "2t", "3t"],
      "usedProducts": ["Масло", "Еще масло"],
      "qrCode": true,
      "qrCodeUse": true,
      "phone": "+7 (999) 999-99-99",
      "gosNumber": "A777AA",
      "region": "86",
      "summa": {
        "full": 2500,
        "sale": 2000,
      },
    },
    {
      "id": "4r",
      "date": "2021-09-25",
      "time": "15:30",
      "city": "Москва",
      "address": "Пр-т Гагарина, 15",
      "services": ["1t", "2t"],
      "usedProducts": ["Не масло"],
      "qrCode": true,
      "qrCodeUse": false,
      "phone": "",
      "gosNumber": "",
      "region": "",
      "summa": {
        "full": 3500,
        "sale": 2500,
      },
    },
  ],
```

| Свойство               | Тип     | Описание                                             |
| ---------------------- | ------- | ---------------------------------------------------- |
| records                | array   | Предстоящие записи                                   |
| records[].id           | string  | ID записи                                            |
| records[].date         | string  | Дата                                                 |
| records[].time         | string  | Время                                                |
| records[].city         | string  | Название или символьный код (зависит от ТЗ)          |
| records[].address      | string  | Название или символьный код (зависит от ТЗ)          |
| records[].services     | array   | Массив ID выбранных услуг                            |
| records[].usedProducts | array   | Массив товаров, используемых в момент оказания услуг |
| records[].qrCode       | boolean | Возможно ли использование QR-кода                    |
| records[].qrCodeUse    | boolean | Был ли QR-код использован                            |
| records[].phone        | string  | Номер телефона                                       |
| records[].gosNumber    | string  | Гос. номер авто                                      |
| records[].region       | string  | Регион авто                                          |
| records[].summa        | object  | Стоимость услуг                                      |
| records[].summa.full   | number  | Полная стоимость                                     |
| records[].summa.sale   | number  | Стоимость со скидкой                                 |

### Сервисная история

GET /api/history/ - получить сервисную историю

Массив аналогичен предстоящим записям

```json
"history": [
    {
      "id": "3r",
      "date": "2021-09-25",
      "time": "15:30",
      "city": "moscow",
      "address": "gagarina15",
      "services": ["1t", "2t", "3t"],
      "usedProducts": ["Масло", "Еще масло"],
      "qrCode": true,
      "qrCodeUse": true,
      "phone": "+7 (999) 999-99-99",
      "gosNumber": "A777AA",
      "region": "86",
      "summa": {
        "full": 2500,
        "sale": 2000,
      },
    },
    {
      "id": "4r",
      "date": "2021-09-25",
      "time": "15:30",
      "city": "Москва",
      "address": "Пр-т Гагарина, 15",
      "services": ["1t", "2t"],
      "usedProducts": ["Не масло"],
      "qrCode": true,
      "qrCodeUse": false,
      "phone": "",
      "gosNumber": "",
      "region": "",
      "summa": {
        "full": 3500,
        "sale": 2500,
      },
    },
  ],
```
